<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>header</title>
    <link rel="stylesheet" th:href="@{/css/header.css}">
    <script th:src="@{/js/header.js}" defer></script>
</head>
<body>
<header th:fragment="header" class="site-header">
    <div class="header-title">
        <a th:href="@{/}">
            <img th:src="@{/img/icon_page.png}" alt="Î°úÍ≥†" class="logo">
        </a>

        <div class="header-links">
            <div class="dropdown">
                <a href="javascript:void(0)" class="dropdown-toggle" onclick="toggleMenu('channel-dropdown', event)">ÂÖ®‰Ωì„ÉÅ„É£„É≥„Éç„É´</a>
                <div class="dropdown-menu" id="channel-dropdown">
                    <th:block th:each="board : ${allBoards}">
                        <a th:href="@{/board/{name}/list(name=${board.name})}" class="channel-item">
                            <span th:text="${board.name}">Í≤åÏãúÌåê Ïù¥Î¶Ñ</span>
                        </a>
                    </th:block>
                    <div th:if="${#lists.isEmpty(allBoards)}" class="no-board">„ÉÅ„É£„É≥„Éç„É´„Åå„ÅÇ„Çä„Åæ„Åõ„Çì„ÄÇ</div>
                </div>
            </div>

            <div class="dropdown" th:if="${#authorization.expression('isAuthenticated()')}">
                <a href="javascript:void(0)" class="dropdown-toggle" onclick="toggleMenu('favorite-dropdown', event)">„ÅäÊ∞ó„Å´ÂÖ•„Çä</a>
                <div class="dropdown-menu" id="favorite-dropdown">
                    <th:block th:if="${not #lists.isEmpty(subscribedBoards)}">
                        <a th:each="board : ${subscribedBoards}" th:href="@{/board/{name}/list(name=${board.name})}"
                           th:text="${board.name}" class="channel-item"></a>
                    </th:block>
                    <div th:if="${#lists.isEmpty(subscribedBoards)}" class="no-board">Ë≥ºË™≠‰∏≠„ÅÆ„ÉÅ„É£„É≥„Éç„É´„ÅØ„ÅÇ„Çä„Åæ„Åõ„Çì„ÄÇ</div>
                </div>
            </div>
        </div>

        <div class="search">
            <input type="text" id="channel-search-input" placeholder="„ÉÅ„É£„É≥„Éç„É´Ê§úÁ¥¢" autocomplete="off">
            <button class="search-btn" type="button">
                <img src="https://s3.ap-northeast-2.amazonaws.com/cdn.wecode.co.kr/icon/search.png" alt="Ê§úÁ¥¢">
            </button>

            <div id="search-results" class="dropdown-menu search-dropdown">
            </div>
        </div>

        <div class="right-group">
            <div th:if="${#authorization.expression('isAuthenticated()')}" class="user-section">
                <div class="profile" id="profile-pic" onclick="toggleMenu('profile-menu', event)">
                    <img th:src="${user?.profileImg != null ? user.profileImg : (#authentication.principal != 'anonymousUser' and #authentication.principal.profileImg != null ? #authentication.principal.profileImg : '/img/default_profile.png')}"
                         alt="„É¶„Éº„Ç∂„Éº„Éó„É≠„Éï„Ç£„Éº„É´">
                    <div class="profile-menu" id="profile-menu">
                        <p><b th:text="${#authentication.name}">„É¶„Éº„Ç∂„Éº</b>Êßò</p>
                        <hr>
                        <div th:if="${#authorization.expression('hasAuthority(''ADMIN'')') or #authorization.expression('hasAuthority(''ROLE_ADMIN'')')}">
                            <p><a th:href="@{/admin/boards}" style="color: #6366f1; font-weight: bold; text-decoration: none;">üõ† ÁÆ°ÁêÜËÄÖ„Éö„Éº„Ç∏</a></p>
                            <hr>
                        </div>
                        <p th:data-url="@{user/edit}"
                           onclick="location.href=this.getAttribute('data-url')"
                           style="cursor: pointer;">
                            „Éû„Ç§ÊÉÖÂ†±
                        </p>
                        <form th:action="@{/api/logout}" method="post" style="margin:0;">
                            <button type="submit" class="logout-btn">„É≠„Ç∞„Ç¢„Ç¶„Éà</button>
                        </form>
                    </div>
                </div>
            </div>

            <div th:unless="${#authorization.expression('isAuthenticated()')}" class="auth-buttons">
                <a th:href="@{/login}" class="login-link">„É≠„Ç∞„Ç§„É≥</a>
            </div>
        </div>
    </div>
</header>

</body>
</html>